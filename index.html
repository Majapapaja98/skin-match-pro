<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SkinMatch ‚ú® Global Glow Pro</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Quicksand:wght@400;600;700&display=swap" rel="stylesheet">
    <script>
        tailwind.config = {
            theme: {
                fontFamily: { sans: ['Quicksand', 'sans-serif'] },
                extend: { boxShadow: { 'glow-pink': '0 0 30px -5px rgba(244, 114, 182, 0.4)' } }
            }
        }
    </script>
    <style>
        .glass { background: rgba(255, 255, 255, 0.9); backdrop-filter: blur(15px); }
        .custom-scroll::-webkit-scrollbar { width: 5px; }
        .custom-scroll::-webkit-scrollbar-thumb { background: #fbcfe8; border-radius: 10px; }
        .tab-active { border-bottom: 3px solid #f472b6; color: #f472b6; font-weight: bold; }
        @keyframes pulse-soft { 0%, 100% { transform: scale(1); } 50% { transform: scale(1.02); } }
        .animate-pulse-soft { animation: pulse-soft 3s infinite; }
    </style>
</head>
<body class="bg-[radial-gradient(ellipse_at_top_right,_var(--tw-gradient-stops))] from-rose-100 via-indigo-50 to-orange-50 min-h-screen font-sans p-4 flex flex-col items-center">

    <div class="w-full max-w-md glass rounded-[3rem] shadow-glow-pink p-8 border border-white relative overflow-hidden">
        
        <div class="flex justify-between items-center mb-8">
            <h1 class="text-2xl font-black text-pink-500 tracking-tighter">SkinMatch <span class="text-indigo-300">Pro</span></h1>
            <div class="flex gap-2">
                <button onclick="showSection('quiz')" class="p-2 hover:bg-pink-100 rounded-full transition">üß¨</button>
                <button onclick="showSection('shelf')" class="p-2 hover:bg-pink-100 rounded-full transition">üß¥</button>
            </div>
        </div>

        <div id="section-matcher" class="space-y-6">
            <div class="text-center bg-white/50 py-3 rounded-2xl mb-6">
                <p id="skin-badge" class="text-[10px] font-bold text-pink-400 uppercase tracking-widest">Global Glow Community</p>
            </div>

            <div class="relative">
                <label class="text-[10px] font-bold text-gray-400 uppercase ml-4 mb-1 block">Step 1: Focus Treatment</label>
                <input type="text" id="search1" oninput="filterProducts(1)" placeholder="Search Brand or Product..." class="w-full p-4 bg-white rounded-3xl shadow-sm outline-none border-2 border-transparent focus:border-pink-300 transition-all text-sm">
                <div id="results1" class="hidden absolute z-30 w-full mt-1 bg-white border rounded-2xl shadow-xl max-h-40 overflow-y-auto custom-scroll"></div>
                <div id="selected1" class="hidden p-4 bg-pink-50 rounded-3xl text-sm font-bold text-pink-600 flex justify-between items-center animate-pulse-soft"><span></span> <button onclick="clearSelection(1)">‚úï</button></div>
            </div>

            <div class="flex justify-center text-pink-200">‚ú¶</div>

            <div class="relative">
                <label class="text-[10px] font-bold text-gray-400 uppercase ml-4 mb-1 block">Step 2: Layer or Seal</label>
                <input type="text" id="search2" oninput="filterProducts(2)" placeholder="Search Brand or Product..." class="w-full p-4 bg-white rounded-3xl shadow-sm outline-none border-2 border-transparent focus:border-indigo-300 transition-all text-sm">
                <div id="results2" class="hidden absolute z-30 w-full mt-1 bg-white border rounded-2xl shadow-xl max-h-40 overflow-y-auto custom-scroll"></div>
                <div id="selected2" class="hidden p-4 bg-indigo-50 rounded-3xl text-sm font-bold text-indigo-600 flex justify-between items-center animate-pulse-soft"><span></span> <button onclick="clearSelection(2)">‚úï</button></div>
            </div>

            <div class="flex bg-gray-100 rounded-2xl p-1">
                <button onclick="setTime('AM')" id="btn-AM" class="flex-1 py-2 text-[10px] font-bold rounded-xl transition bg-white text-pink-500 shadow-sm">‚òÄÔ∏è MORNING</button>
                <button onclick="setTime('PM')" id="btn-PM" class="flex-1 py-2 text-[10px] font-bold rounded-xl transition text-gray-400">üåô EVENING</button>
            </div>

            <div id="result-box" class="hidden p-6 rounded-[2.5rem] text-center border-2 animate-slide-up">
                <div id="result-icon" class="text-5xl mb-3"></div>
                <div id="result-title" class="font-bold text-lg mb-1"></div>
                <p id="result-text" class="text-[11px] leading-relaxed mb-4"></p>
                <div id="ingredient-tip" class="text-[9px] bg-white/50 p-3 rounded-xl italic text-gray-500"></div>
            </div>
        </div>

        <div id="section-shelf" class="hidden space-y-4">
            <h3 class="text-center font-bold text-pink-500">My Secret Shelf ü§´</h3>
            <div class="bg-pink-50 p-5 rounded-3xl border-2 border-dashed border-pink-200">
                <input type="text" id="new-brand" placeholder="Brand..." class="w-full p-3 mb-2 rounded-xl text-xs outline-pink-200 border-none">
                <input type="text" id="new-name" placeholder="Product Name..." class="w-full p-3 mb-2 rounded-xl text-xs outline-pink-200 border-none">
                <div class="flex gap-2 mb-4">
                    <select id="new-active" class="flex-1 p-3 rounded-xl text-[10px] font-bold outline-pink-200 border-none">
                        <option value="retinol">Active: Retinol</option>
                        <option value="vit_c">Active: Vitamin C</option>
                        <option value="acids">Active: Acids (Exfoliant)</option>
                        <option value="niacinamide">Active: Niacinamide</option>
                        <option value="peptides">Active: Peptides</option>
                        <option value="hyaluronic">Active: Hydrator/Base</option>
                    </select>
                    <input type="number" id="new-pao" placeholder="PAO (Months)" class="w-20 p-3 rounded-xl text-xs outline-pink-200 border-none">
                </div>
                <button onclick="saveToShelf()" class="w-full bg-pink-400 text-white py-3 rounded-2xl font-bold text-[10px] uppercase shadow-md">Add to Collection</button>
            </div>
            <div id="shelf-list" class="space-y-2 max-h-48 overflow-y-auto custom-scroll">
                </div>
        </div>
    </div>

    <script>
        // --- GLOBAL SETTINGS & DATA ---
        let currentDayTime = 'AM';
        const productDB = [
            { brand: "The Ordinary", name: "Retinol 1% in Squalane", active: "retinol", am_safe: false },
            { brand: "The Ordinary", name: "Ascorbyl Glucoside Sol. 12%", active: "vit_c", am_safe: true },
            { brand: "CeraVe", name: "Hydrating Facial Cleanser", active: "hyaluronic", am_safe: true },
            { brand: "Paula's Choice", name: "2% BHA Liquid Exfoliant", active: "acids", am_safe: false },
            { brand: "Skinceuticals", name: "C E Ferulic", active: "vit_c", am_safe: true },
            { brand: "La Roche-Posay", name: "Effaclar Serum", active: "acids", am_safe: false }
        ];

        const glossary = {
            retinol: "Anti-aging powerhouse. Stimulates collagen but makes skin sun-sensitive.",
            vit_c: "Antioxidant that brightens skin and protects against pollution.",
            acids: "Exfoliates dead cells. Great for glow, but don't overdo it!",
            niacinamide: "Oil control and pore minimizer. Generally very safe.",
            peptides: "The 'building blocks' of skin. Great for firmness.",
            hyaluronic: "Magnet for moisture. Holds 1000x its weight in water."
        };

        const conflicts = {
            'retinol_acids': { type: 'error', icon: 'ü©π', title: 'Skin Barrier Alert!', msg: 'Both ingredients are heavy exfoliants. Using them together might cause peeling or burns.' },
            'retinol_vit_c': { type: 'warning', icon: 'üåô', title: 'Schedule Tweak', msg: 'Best split: Vitamin C for AM protection, Retinol for PM repair.' },
            'peptides_vit_c': { type: 'warning', icon: 'üß™', title: 'Science Conflict', msg: 'Pure Vit C can destabilize Copper Peptides. Use them at different times.' }
        };

        let userShelf = JSON.parse(localStorage.getItem('globalShelf')) || [];
        let selected = [null, null];

        // --- CORE FUNCTIONS ---
        function setTime(time) {
            currentDayTime = time;
            document.getElementById('btn-AM').className = time === 'AM' ? 'flex-1 py-2 text-[10px] font-bold rounded-xl bg-white text-pink-500 shadow-sm' : 'flex-1 py-2 text-[10px] font-bold rounded-xl text-gray-400';
            document.getElementById('btn-PM').className = time === 'PM' ? 'flex-1 py-2 text-[10px] font-bold rounded-xl bg-white text-indigo-500 shadow-sm' : 'flex-1 py-2 text-[10px] font-bold rounded-xl text-gray-400';
            checkCompatibility();
        }

        function filterProducts(num) {
            const val = document.getElementById('search' + num).value.toLowerCase();
            const resDiv = document.getElementById('results' + num);
            if (val.length < 2) { resDiv.classList.add('hidden'); return; }

            const fullDB = [...productDB, ...userShelf];
            const filtered = fullDB.filter(p => p.brand.toLowerCase().includes(val) || p.name.toLowerCase().includes(val));

            resDiv.innerHTML = '';
            filtered.forEach(p => {
                const item = document.createElement('div');
                item.className = 'p-4 hover:bg-pink-50 cursor-pointer text-[11px] border-b border-gray-50 flex justify-between items-center';
                item.innerHTML = `<div><b class="text-pink-400 uppercase text-[9px]">${p.brand}</b><br>${p.name}</div>`;
                item.onclick = () => selectProduct(num, p);
                resDiv.appendChild(item);
            });
            resDiv.classList.remove('hidden');
        }

        function selectProduct(num, product) {
            selected[num-1] = product;
            document.getElementById('search' + num).classList.add('hidden');
            document.getElementById('results' + num).classList.add('hidden');
            const selDiv = document.getElementById('selected' + num);
            selDiv.querySelector('span').innerText = product.brand + " - " + product.name;
            selDiv.classList.remove('hidden');
            checkCompatibility();
        }

        function checkCompatibility() {
            if (!selected[0] || !selected[1]) return;
            const resBox = document.getElementById('result-box');
            resBox.classList.remove('hidden');

            const a = selected[0], b = selected[1];
            const combo = a.active + '_' + b.active;
            const comboRev = b.active + '_' + a.active;
            const conflict = conflicts[combo] || conflicts[comboRev];

            // AM/PM Logic Check
            const amDanger = currentDayTime === 'AM' && (!a.am_safe || !b.am_safe);

            if (amDanger) {
                updateUI('‚òÄÔ∏è', 'PM Preferred', 'One of your products contains Retinol or Acids. These are best for evening use to avoid sun damage.', 'bg-orange-50 border-orange-200 text-orange-800');
            } else if (conflict) {
                updateUI(conflict.icon, conflict.title, conflict.msg, conflict.type === 'error' ? 'bg-rose-50 border-rose-200 text-rose-800' : 'bg-amber-50 border-amber-200 text-amber-800');
            } else {
                updateUI('‚ú®', 'Safe Routine!', 'These ingredients play well together. Don\'t forget your SPF during the day!', 'bg-emerald-50 border-emerald-200 text-emerald-800');
            }

            document.getElementById('ingredient-tip').innerText = `Pro Tip: ${glossary[a.active]}`;
        }

        function updateUI(icon, title, text, style) {
            const box = document.getElementById('result-box');
            box.className = `p-6 rounded-[2.5rem] text-center border-2 mt-8 animate-slide-up ${style}`;
            document.getElementById('result-icon').innerText = icon;
            document.getElementById('result-title').innerText = title;
            document.getElementById('result-text').innerText = text;
        }

        function saveToShelf() {
            const b = document.getElementById('new-brand').value;
            const n = document.getElementById('new-name').value;
            const a = document.getElementById('new-active').value;
            const p = document.getElementById('new-pao').value;
            if(!b || !n) return;

            const newItem = { brand: b, name: n, active: a, pao: p, opened: new Date().toISOString(), am_safe: a !== 'retinol' && a !== 'acids' };
            userShelf.push(newItem);
            localStorage.setItem('globalShelf', JSON.stringify(userShelf));
            showSection('matcher');
            alert('Saved to your collection! üå∏');
        }

        function showSection(name) {
            document.getElementById('section-matcher').className = name === 'matcher' ? 'space-y-6' : 'hidden';
            document.getElementById('section-shelf').className = name === 'shelf' ? 'space-y-4' : 'hidden';
        }

        function clearSelection(n) {
            selected[n-1] = null;
            document.getElementById('search' + n).classList.remove('hidden');
            document.getElementById('selected' + n).classList.add('hidden');
            document.getElementById('result-box').classList.add('hidden');
        }
    </script>
</body>
</html>
