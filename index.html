<!DOCTYPE html>
<html lang="pl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SkinMatch ‚ú® Professional Glow</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Quicksand:wght@400;600;700&display=swap" rel="stylesheet">
    <script>
        tailwind.config = {
            theme: {
                fontFamily: { sans: ['Quicksand', 'sans-serif'] },
                extend: { boxShadow: { 'soft-pink': '0 20px 50px -12px rgba(244, 114, 182, 0.4)' } }
            }
        }
    </script>
    <style>
        .glass { background: rgba(255, 255, 255, 0.95); backdrop-filter: blur(12px); }
        .quiz-option:checked + label { background: #fbcfe8; border-color: #f472b6; color: #9d174d; }
        @keyframes slideIn { from { opacity: 0; transform: translateY(20px); } to { opacity: 1; transform: translateY(0); } }
        .animate-slide { animation: slideIn 0.4s ease-out forwards; }
    </style>
</head>
<body class="bg-[conic-gradient(at_top_left,_var(--tw-gradient-stops))] from-pink-100 via-purple-50 to-orange-50 min-h-screen p-4 flex flex-col items-center">

    <div id="quiz-modal" class="fixed inset-0 z-[100] flex items-center justify-center p-4 bg-pink-200/40 backdrop-blur-md">
        <div class="bg-white w-full max-w-md rounded-[3rem] shadow-soft-pink p-8 animate-slide">
            <div id="quiz-content">
                <div class="text-center mb-6">
                    <span class="text-3xl">ü©∫</span>
                    <h2 class="text-2xl font-bold text-gray-800 mt-2">Analiza Cery</h2>
                    <p class="text-xs text-pink-400 font-bold uppercase tracking-widest">Krok <span id="quiz-step">1</span> z 4</p>
                </div>
                
                <h3 id="quiz-question" class="text-lg font-semibold text-center text-gray-700 mb-8 h-12">Jak czuje siƒô Twoja sk√≥ra rano?</h3>
                
                <div id="quiz-options" class="space-y-3">
                    </div>

                <div class="mt-8 flex justify-between items-center">
                    <button id="prev-btn" onclick="prevStep()" class="text-gray-400 text-sm font-bold opacity-0 transition">Powr√≥t</button>
                    <div id="quiz-dots" class="flex gap-2"></div>
                </div>
            </div>

            <div id="quiz-result" class="hidden text-center">
                <div class="w-20 h-20 bg-pink-100 rounded-full flex items-center justify-center mx-auto mb-4 text-3xl">‚ú®</div>
                <h2 class="text-xl font-bold text-gray-800 mb-2">Twoja Recepta Blasku</h2>
                <div id="skin-type-tag" class="inline-block bg-pink-500 text-white text-[10px] px-3 py-1 rounded-full font-bold mb-4 uppercase">Cera Mieszana</div>
                <p class="text-sm text-gray-500 mb-6">Na podstawie Twoich odpowiedzi, Twoja sk√≥ra potrzebuje g≈Ç√≥wnie:</p>
                <div id="recommended-list" class="flex flex-wrap justify-center gap-2 mb-8 text-[10px] font-bold">
                    </div>
                <button onclick="closeQuiz()" class="w-full bg-pink-500 text-white py-4 rounded-2xl font-bold shadow-lg hover:scale-[1.02] transition">ZACZNIJ PIELƒòGNACJƒò</button>
            </div>
        </div>
    </div>

    <main id="app-content" class="w-full max-w-md glass rounded-[2.5rem] shadow-soft-pink p-8 border-2 border-pink-100 blur-sm">
        <div class="flex items-center justify-between mb-8">
            <div>
                <h1 class="text-2xl font-bold text-pink-500">SkinMatch</h1>
                <p id="user-skin-info" class="text-[10px] font-bold text-pink-300 uppercase tracking-tighter cursor-pointer" onclick="openQuiz()">Zmie≈Ñ profil cery ‚öôÔ∏è</p>
            </div>
            <button onclick="toggleAddForm()" class="bg-pink-400 text-white text-[10px] font-bold px-4 py-2 rounded-full shadow-md">+ DODAJ PRODUKT</button>
        </div>

        <div class="space-y-4">
            <div class="relative">
                <input type="text" id="search1" oninput="filterProducts(1)" placeholder="Szukaj produktu nr 1..." class="w-full p-4 bg-white rounded-2xl border-2 border-pink-50 focus:border-pink-300 outline-none text-sm">
                <div id="results1" class="hidden absolute z-30 w-full mt-1 bg-white border rounded-2xl shadow-xl max-h-40 overflow-y-auto"></div>
                <div id="selected1" class="hidden p-4 bg-pink-100 rounded-2xl text-xs font-bold text-pink-600 flex justify-between items-center"><span></span> <button onclick="clearSelection(1)">‚úï</button></div>
            </div>
            <div class="text-center font-bold text-pink-200">X</div>
            <div class="relative">
                <input type="text" id="search2" oninput="filterProducts(2)" placeholder="Szukaj produktu nr 2..." class="w-full p-4 bg-white rounded-2xl border-2 border-pink-50 focus:border-pink-300 outline-none text-sm">
                <div id="results2" class="hidden absolute z-30 w-full mt-1 bg-white border rounded-2xl shadow-xl max-h-40 overflow-y-auto"></div>
                <div id="selected2" class="hidden p-4 bg-purple-100 rounded-2xl text-xs font-bold text-purple-600 flex justify-between items-center"><span></span> <button onclick="clearSelection(2)">‚úï</button></div>
            </div>
        </div>

        <div id="result-box" class="hidden mt-8 p-6 rounded-[2rem] text-center border-2 transition-all">
            <div id="result-icon" class="text-5xl mb-3"></div>
            <div id="result-title" class="font-bold text-lg mb-1"></div>
            <div id="result-text" class="text-[11px] opacity-90"></div>
        </div>
    </main>

    <script>
        // --- LOGIKA QUIZU ---
        const questions = [
            { q: "Jak czuje siƒô Twoja sk√≥ra rano?", opts: [
                { t: "Napiƒôta i sucha", tags: ["dry", "hydration"] },
                { t: "B≈ÇyszczƒÖca w strefie T", tags: ["combination", "sebum"] },
                { t: "Ca≈Ça siƒô ≈õwieci", tags: ["oily", "acne"] },
                { t: "Czƒôsto piecze/czerwieni siƒô", tags: ["sensitive", "soothing"] }
            ]},
            { q: "Tw√≥j najwiƒôkszy cel pielƒôgnacyjny?", opts: [
                { t: "Zmarszczki i jƒôdrno≈õƒá", tags: ["anti-aging", "peptides"] },
                { t: "Wypryski i zask√≥rniki", tags: ["acne", "acids"] },
                { t: "Przebarwienia i brak blasku", tags: ["glow", "vit_c"] },
                { t: "Ukojenie i regeneracja", tags: ["soothing", "ceramides"] }
            ]},
            { q: "Jak reagujesz na nowe kosmetyki?", opts: [
                { t: "Zazwyczaj bez problemu", tags: ["normal"] },
                { t: "Czasem mnie zapychajƒÖ", tags: ["oily"] },
                { t: "Czƒôsto mam zaczerwienienia", tags: ["sensitive"] }
            ]},
            { q: "Ile masz lat? (Wp≈Çywa na tempo odnowy)", opts: [
                { t: "Poni≈ºej 25", tags: ["prevention"] },
                { t: "25 - 35", tags: ["retinization"] },
                { t: "Powy≈ºej 35", tags: ["aging"] }
            ]}
        ];

        let currentStep = 0;
        let userTags = [];

        function initQuiz() {
            const step = questions[currentStep];
            document.getElementById('quiz-step').innerText = currentStep + 1;
            document.getElementById('quiz-question').innerText = step.q;
            const optsDiv = document.getElementById('quiz-options');
            optsDiv.innerHTML = '';
            
            step.opts.forEach((opt, i) => {
                const btn = document.createElement('button');
                btn.className = "w-full p-4 text-sm font-semibold text-gray-600 bg-gray-50 rounded-2xl border-2 border-transparent hover:border-pink-300 transition text-left";
                btn.innerText = opt.t;
                btn.onclick = () => nextStep(opt.tags);
                optsDiv.appendChild(btn);
            });

            document.getElementById('prev-btn').style.opacity = currentStep > 0 ? "1" : "0";
        }

        function nextStep(tags) {
            userTags.push(...tags);
            if (currentStep < questions.length - 1) {
                currentStep++;
                initQuiz();
            } else {
                showQuizResult();
            }
        }

        function showQuizResult() {
            document.getElementById('quiz-content').classList.add('hidden');
            document.getElementById('quiz-result').classList.remove('hidden');
            
            const results = {
                'retinol': userTags.filter(t => t === 'aging' || t === 'anti-aging').length,
                'vit_c': userTags.filter(t => t === 'glow').length,
                'acids': userTags.filter(t => t === 'acne' || t === 'sebum').length,
                'ceramides': userTags.filter(t => t === 'dry' || t === 'sensitive').length,
                'peptides': userTags.filter(t => t === 'anti-aging').length
            };

            const sorted = Object.entries(results).sort((a,b) => b[1] - a[1]);
            const list = document.getElementById('recommended-list');
            list.innerHTML = '';
            
            sorted.slice(0,3).forEach(([key, val]) => {
                const tag = document.createElement('span');
                tag.className = "bg-pink-100 text-pink-600 px-4 py-2 rounded-full";
                tag.innerText = key.toUpperCase().replace('_', ' ');
                list.appendChild(tag);
            });

            const type = userTags.includes('dry') ? 'Cera Sucha' : (userTags.includes('oily') ? 'Cera T≈Çusta' : 'Cera Mieszana');
            document.getElementById('skin-type-tag').innerText = type;
            localStorage.setItem('userSkinType', type);
        }

        function closeQuiz() {
            document.getElementById('quiz-modal').classList.add('hidden');
            document.getElementById('app-content').classList.remove('blur-sm');
            document.getElementById('user-skin-info').innerText = "Profil: " + localStorage.getItem('userSkinType') + " ‚öôÔ∏è";
        }

        function openQuiz() {
            currentStep = 0;
            userTags = [];
            document.getElementById('quiz-content').classList.remove('hidden');
            document.getElementById('quiz-result').classList.add('hidden');
            document.getElementById('quiz-modal').classList.remove('hidden');
            initQuiz();
        }

        // --- INICJALIZACJA ---
        initQuiz();
        
        // [TUTAJ WKLEJ POPRZEDNIƒÑ LOGIKƒò WYSZUKIWANIA I KONFLIKT√ìW Z POPRZEDNIEJ ODPOWIEDZI]
        // Dla zaoszczƒôdzenia miejsca nie dublujƒô funkcji filterProducts, selectProduct i checkMatch, 
        // kt√≥re dzia≈ÇajƒÖ tak samo jak w wersji "Glow & Print Edition".
    </script>
</body>
</html>
